TASK: Security & Performance Hardening — FINAL CLEANUP (NO BREAKING CHANGES)

CONTEXT:
This is a production React SPA running behind Cloudflare (travi.world).
The site is stable, indexed, and live.
Multiple professional audits were performed (MDN HTTP Observatory, Qualys SSL Labs, SecurityHeaders, PageSpeed, Carbon, Rich Results).

CURRENT PROBLEMS (CONFIRMED):
1. Content Security Policy is too permissive (unsafe-inline, broad sources).
2. Some cookies are missing Secure / HttpOnly flags.
3. HSTS is either duplicated or not configured in a way that scoring tools recognize.
4. Hero images and media loading strategy can be optimized without UX changes.
5. All fixes must NOT break:
   - React SPA
   - Analytics (GA / PostHog)
   - Cloudflare proxy
   - Search indexing
   - Existing UX or animations

OBJECTIVE:
Harden security and performance to reach:
- MDN HTTP Observatory: A / A+
- Qualys SSL Labs: A
- SecurityHeaders: A+
- Improved Mobile LCP and Carbon score
WITHOUT introducing regressions.

STRICT RULES:
- DO NOT change product behavior.
- DO NOT remove analytics.
- DO NOT break inline styles/scripts unless safely replaced.
- NO “best effort” — changes must be explicit and correct.
- Prefer incremental hardening over aggressive locking.

REQUIRED IMPLEMENTATIONS:

A. CONTENT SECURITY POLICY (CODE LEVEL)
- Replace unsafe-inline in script-src with nonce-based CSP.
- Keep unsafe-inline ONLY for style-src if unavoidable.
- Explicitly whitelist:
  - self
  - Cloudflare
  - Google Analytics / Tag Manager
  - PostHog
- Remove overly broad sources (e.g. https: wildcard) where possible.
- Ensure CSP works with React hydration and does not break runtime.

B. COOKIES HARDENING
- Ensure all non-essential cookies include:
  - Secure
  - SameSite=Lax (or Strict where safe)
- Add HttpOnly where the cookie is not required by client-side JS.
- Do NOT break GA / PostHog tracking.

C. HSTS CLEANUP (CODE-AWARE, CLOUD READY)
- Ensure NO duplicate HSTS headers are sent.
- HSTS must be compatible with Cloudflare-managed headers.
- Target configuration:
  max-age=31536000; includeSubDomains; preload
- If HSTS is already handled by Cloudflare, REMOVE app-level duplication.

D. IMAGE & MEDIA LOADING (SAFE OPTIMIZATION)
- Ensure exactly ONE hero image per page uses:
  fetchpriority="high"
- All other images:
  loading="lazy"
- No layout shifts.
- No visual changes.

E. VERIFICATION REQUIREMENTS
After implementation, verify:
- No CSP violations in browser console
- App loads correctly in production
- Search, navigation, analytics all function
- No React hydration errors

DELIVERABLES:
1. Exact code changes (files + diffs explanation)
2. Final CSP header string
3. Confirmation that Cloudflare and app headers do not conflict
4. Short verification checklist with results

FAILURE CONDITIONS (DO NOT PROCEED IF ANY OCCUR):
- Blank page
- Broken search
- Missing analytics
- CSP errors in console
- SEO meta/schema regression

This is a FINAL hardening pass — not experimentation.
Proceed carefully and report precisely.